variables:
  # Settings
  invis_duration:         30 # seconds

  # Blocks
  invis_block_1:          368;51;-460;marocraft
  invis_block_2:          401;59;-441;marocraft

  # Teleport 1
  inv_tp_1a:
    region:               bbh_inv_tp_1a
    loc:                  373;50;-459;marocraft;0;12
  inv_tp_1b:
    region:               bbh_inv_tp_1b
    loc:                  373;48;-466;marocraft;180;12
  # Teleport 2
  inv_tp_2a:
    region:               bbh_inv_tp_2a
    loc:                  387;66;-461;marocraft;90;12
  inv_tp_2b:
    region:               bbh_inv_tp_2b
    loc:                  393;66;-463;marocraft;-90;12


events:
  init_cinv:              "folder e_init_cinv_blocks"
  deit_cinv:              "folder e_deit_cinv_blocks,e_deit_cinv_tps,e_deit_invisibility"

  # --- Init ---
  # Blocks
  e_init_cinv_blocks:     "folder e_obj_add_inv_blk_g1"
  e_obj_add_inv_blk_g1:   "folder e_obj_add_inv_blk_1,e_obj_add_inv_blk_2"
  e_obj_add_inv_blk_1:    "objective add o_invis_activate_1"
  e_obj_add_inv_blk_2:    "objective add o_invis_activate_2"

  # Teleports
  e_init_cinv_tps:        "folder e_obj_add_inv_tp_g1"
  e_obj_add_inv_tp_g1:    "folder e_obj_add_inv_tp_1,e_obj_add_inv_tp_2"
  e_obj_add_inv_tp_1:     "run ^objective add o_invis_tp_1a ^objective add o_invis_tp_1b"
  e_obj_add_inv_tp_2:     "run ^objective add o_invis_tp_2a ^objective add o_invis_tp_2b"

  
  # --- Main ---
  # Invisibility: Activate
  e_start_invisibility:   "folder e_play_music_invis,e_obj_add_inv_timeout,e_tag_add_invis,e_notif_invisible,e_efx_give_invis,e_init_cinv_tps"
  e_play_music_invis:     "folder core-music.e_play_powerup"
  e_obj_add_inv_timeout:  "objective add o_invis_timeout"
  e_tag_add_invis:        "tag add cap_invisible"
  e_notif_invisible:      "notify &3Invisibility for $invis_duration$ sec\n&2You can go through paintings io:title"
  e_efx_give_invis:       "effect INVISIBILITY $invis_duration$ 1 hidden noicon"

  # Invisibility: Deactivate
  e_stop_invisibility:    "folder e_play_music,e_deit_invisibility"


  # Invisibility: Cleanup
  e_deit_invisibility:    "folder e_obj_del_inv_timeout,e_tag_del_invis,e_efx_clear_invis,e_deit_cinv_tps"
  e_obj_del_inv_timeout:  "objective remove o_invis_timeout"
  e_tag_del_invis:        "tag delete invisible"
  e_efx_clear_invis:      "deleffect INVISIBILITY"

  # Invisibility: Teleport
  e_invis_tp_1a_to_1b:    "teleport $inv_tp_1b.loc$"
  e_invis_tp_1b_to_1a:    "teleport $inv_tp_1a.loc$"
  e_invis_tp_2a_to_2b:    "teleport $inv_tp_2b.loc$"
  e_invis_tp_2b_to_2a:    "teleport $inv_tp_2a.loc$"



  # --- Cleanup ---
  # Blocks
  e_deit_cinv_blocks:     "folder e_obj_del_inv_blk_g1"
  e_obj_del_inv_blk_g1:   "folder e_obj_del_inv_blk_1,e_obj_del_inv_blk_2"
  e_obj_del_inv_blk_1:    "objective remove o_invis_activate_1"
  e_obj_del_inv_blk_2:    "objective remove o_invis_activate_2"

  # Teleports 
  e_deit_cinv_tps:        "folder e_obj_del_inv_tp_g1"
  e_obj_del_inv_tp_g1:    "folder e_obj_del_inv_tp_1,e_obj_del_inv_tp_2"
  e_obj_del_inv_tp_1:     "run ^objective remove o_invis_tp_1a ^objective remove o_invis_tp_1b"
  e_obj_del_inv_tp_2:     "run ^objective remove o_invis_tp_2a ^objective remove o_invis_tp_2b"


conditions:
  chk_tag_invisible:      "tag cap_invisible"


objectives:
  # Deactivate
  o_invis_timeout:        "delay $invis_block_1$ seconds interval:5 event:e_stop_invis"

  # Blocks
  o_invis_activate_1:     "action right any loc:$invis_block_1$ conditions:!chk_tag_invisible events:e_start_invis persistent"
  o_invis_activate_2:     "action right any loc:$invis_block_2$ conditions:!chk_tag_invisible events:e_start_invis persistent"
  # Teleports
  o_invis_tp_1a:          "region $inv_tp_1a.region$ enter conditions:chk_tag_invisible events:e_invis_tp_1a_to_1b persistent"
  o_invis_tp_1b:          "region $inv_tp_1b.region$ enter conditions:chk_tag_invisible events:e_invis_tp_1b_to_1a persistent"
  o_invis_tp_2a:          "region $inv_tp_2a.region$ enter conditions:chk_tag_invisible events:e_invis_tp_2a_to_2b persistent"
  o_invis_tp_2b:          "region $inv_tp_2b.region$ enter conditions:chk_tag_invisible events:e_invis_tp_2b_to_2a persistent"