variables:
  s1:
    star_loc:             -874;46;-541;marocraft
    npc_bb:               7


events:
  ### STAR 1 - BOIL THE BIG BULLY
  # Init
  init_s1:                "folder e_obj_add_s1_kbb"
  e_obj_add_s1_kbb:       "objective add o_s1_kill_bb"

  # Killed big bully
  e_s1_bb_killed:         "folder e_s1_spawn_star,core-sfx.e_star_spawn,e_s1_notif_spawn_star,e_obj_add_s1_star,e_s1_gp_add_star,e_s1_tag_add_spawned,e_s1_pardon_player"
  e_s1_spawn_star:        "setblock RAW_GOLD_BLOCK $s1.star_loc$"
  e_s1_notif_spawn_star:  "notify &3A star has spawned! io:title"
  e_obj_add_s1_star:      "objective add o_s1_star"
  e_s1_gp_add_star:       "globalpoint lll_s1 1 action:add"
  e_s1_tag_add_spawned:   "tag add s1_spawned"
  e_s1_pardon_player:     "command lp user %player% parent add bb_whitelist"

  # Win
  win_s1:                 "folder e_notif_s1_win,core-sfx.e_got_star,if_firstwin_s1,cleanup_s1"
  e_notif_s1_win:         "notify &3Bully the big bully\n&2Cleared! io:title"

  # First win
  if_firstwin_s1:         "if !chk_s1_obtained firstwin_s1 else core-main.e_dummy"
  firstwin_s1:            "folder e_broad_s1_first,tag_add_s1_win,e_stop_music,exit_star"
  e_broad_s1_first:       "command broadcast &6%player% &2got a star: [LLL] Bully the big bully"
  tag_add_s1_win:         "tag add s1"

  # Cleanup
  cleanup_s1:             "folder e_obj_del_s1_star,e_obj_del_s1_kbb,if_s1_gotten,if_s1_spawned,e_s1_tag_del_spawned"
  e_obj_del_s1_star:      "objective remove o_s1_star"
  e_obj_del_s1_kbb:       "objective remove o_s1_kill_bb"

  if_s1_spawned:          "if chk_s1_spawned e_s1_del_spawned else core-main.e_dummy"
  e_s1_del_spawned:       "folder e_s1_gp_sub_star,if_s1_despawn"
  e_s1_gp_sub_star:       "globalpoint lll_s1 1 action:subtract"
  if_s1_despawn:          "if !chk_s1_spawn_count e_s1_delete_star else core-main.e_dummy"
  e_s1_tag_del_spawned:   "tag delete s1_spawned"

  if_s1_gotten:           "if !chk_s1_obtained e_s1_attack_player else core-main.e_dummy"
  e_s1_attack_player:     "command lp user %player% parent remove bb_whitelist"

  e_s1_delete_star:       "folder e_s1_despawn_star,e_s1_reset_star_count"
  e_s1_despawn_star:      "setblock AIR $s1.star_loc$"
  e_s1_reset_star_count:  "globalpoint lll_s1 0 action:set"


conditions:
  chk_s1_obtained:        "tag s1"
  chk_s1_spawned:         "tag s1_spawned"
  chk_s1_spawn_count:     "globalpoint lll_s1 1"


objectives:
  o_s1_kill_bb:           "npckill $s1.npc_bb$ amount:1 events:e_s1_bb_killed"
  o_s1_star:              "action right any loc:$s1.star_loc$ events:win_s1"
