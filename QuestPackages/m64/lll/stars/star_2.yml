variables:
  s2:
    star_loc:             -829;41;-526;marocraft
    npc_sb_1:             8
    npc_sb_2:             9
    npc_sb_3:             10


### STAR 2 - BULLY THE BULLIES
events:
  init_s2:                "folder e_obj_add_s2_ksb_1,e_obj_add_s2_ksb_2,e_obj_add_s2_ksb_3"
  e_obj_add_s2_ksb_1:     "objective add o_s2_kill_sb_1"
  e_obj_add_s2_ksb_2:     "objective add o_s2_kill_sb_2"
  e_obj_add_s2_ksb_3:     "objective add o_s2_kill_sb_3"

  # Killed small bully 1
  e_s2_sb_killed_1:       "folder e_s2_tag_add_sb_1,core-sfx.e_coin,if_all_bullies_s2"
  e_s2_tag_add_sb_1:      "tag add s2_sb_1"
  # Killed small bully 2
  e_s2_sb_killed_2:       "folder e_s2_tag_add_sb_2,core-sfx.e_coin,if_all_bullies_s2"
  e_s2_tag_add_sb_2:      "tag add s2_sb_2"
  # Killed small bully 3
  e_s2_sb_killed_3:       "folder e_s2_tag_add_sb_3,core-sfx.e_coin,if_all_bullies_s2"
  e_s2_tag_add_sb_3:      "tag add s2_sb_3"

  # Check if all bullies killed
  if_all_bullies_s2:      "if chk_s2_killed_sb_all e_s2_all_sb_killed else core-main.e_dummy"
  # All bullies killed
  e_s2_all_sb_killed:     "folder e_s2_spawn_star,core-sfx.e_star_spawn,e_s2_notif_spawn_star,e_obj_add_s2_star,e_s2_gp_add_star,e_s2_tag_add_spawned,e_s2_pardon_player"
  e_s2_spawn_star:        "setblock RAW_GOLD_BLOCK $s2.star_loc$"
  e_s2_notif_spawn_star:  "notify &3A star has spawned! io:title"
  e_obj_add_s2_star:      "objective add o_s2_star"
  e_s2_gp_add_star:       "globalpoint lll_s2 1 action:add"
  e_s2_tag_add_spawned:   "tag add s2_spawned"
  e_s2_pardon_player:     "command lp user %player% parent add sb_whitelist"

  # Win
  win_s2:                 "folder e_notif_s2_win,core-sfx.e_got_star,if_firstwin_s2,deit_s2"
  e_notif_s2_win:         "notify &3Bully the bullies\n&2Cleared! io:title"

  # First win
  if_firstwin_s2:         "if !chk_s2_obtained firstwin_s2 else core-main.e_dummy"
  firstwin_s2:            "folder e_broad_s2_first,tag_add_s2_win,e_stop_music,exit_star"
  e_broad_s2_first:       "command broadcast &6%player% &2got a star: [LLL] Bully the bullies"
  tag_add_s2_win:         "tag add s2"

  # Cleanup
  deit_s2:                "folder e_s2_del_objs,e_s2_del_tags,if_s2_gotten,if_s2_spawned,e_s2_tag_del_spawned"
  e_s2_del_objs:          "folder e_obj_del_s2_star,e_obj_del_s2_ksb_1,e_obj_del_s2_ksb_2,e_obj_del_s2_ksb_3"
  e_obj_del_s2_star:      "objective remove o_s2_star"
  e_obj_del_s2_ksb_1:     "objective remove o_s2_kill_sb_1"
  e_obj_del_s2_ksb_2:     "objective remove o_s2_kill_sb_2"
  e_obj_del_s2_ksb_3:     "objective remove o_s2_kill_sb_3"
  e_s2_del_tags:          "run ^tag delete s2_sb_1 ^tag delete s2_sb_2 ^tag delete s2_sb_3"

  if_s2_spawned:          "if chk_s2_spawned e_s2_del_spawned else core-main.e_dummy"
  e_s2_del_spawned:       "folder e_s2_gp_sub_star,if_s2_despawn"
  e_s2_gp_sub_star:       "globalpoint lll_s2 1 action:subtract"
  if_s2_despawn:          "if !chk_s2_spawn_count e_s2_delete_star else core-main.e_dummy"
  e_s2_tag_del_spawned:   "tag delete s2_spawned"

  if_s2_gotten:           "if !chk_s2_obtained e_s2_attack_player else core-main.e_dummy"
  e_s2_attack_player:     "command lp user %player% parent remove sb_whitelist"

  e_s2_delete_star:       "folder e_s2_despawn_star,e_s2_reset_star_count"
  e_s2_despawn_star:      "setblock AIR $s2.star_loc$"
  e_s2_reset_star_count:  "globalpoint lll_s2 0 action:set"


conditions:
  chk_s2_obtained:        "tag s2"
  chk_s2_killed_sb_1:     "tag s2_sb_1"
  chk_s2_killed_sb_2:     "tag s2_sb_2"
  chk_s2_killed_sb_3:     "tag s2_sb_3"
  chk_s2_killed_sb_all:   "and chk_s2_killed_sb_1,chk_s2_killed_sb_2,chk_s2_killed_sb_3"
  chk_s2_spawned:         "tag s2_spawned"
  chk_s2_spawn_count:     "globalpoint lll_s2 1"


objectives:
  o_s2_kill_sb_1:         "npckill $s2.npc_sb_1$ amount:1 events:e_s2_sb_killed_1"
  o_s2_kill_sb_2:         "npckill $s2.npc_sb_2$ amount:1 events:e_s2_sb_killed_2"
  o_s2_kill_sb_3:         "npckill $s2.npc_sb_3$ amount:1 events:e_s2_sb_killed_3"
  o_s2_star:              "action right any loc:$s2.star_loc$ events:win_s2"
