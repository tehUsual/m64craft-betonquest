variables:
  s6:
    star_loc:             -913;87;388;marocraft
    star_loc_xyz:         -913 87 388
    sc1:                  -943;84;387;marocraft
    sc2:                  -943;84;362;marocraft
    sc3:                  -925;89;364;marocraft
    sc4:                  -929;97;364;marocraft
    sc5:                  -925;105;364;marocraft


### STAR 6 - PYRAMID PUZZLE
events:
  init_s6:                "folder e_s6_add_obj_sc"
  e_s6_add_obj_sc:        "folder e_obj_add_s6_sc1,e_obj_add_s6_sc2,e_obj_add_s6_sc3,e_obj_add_s6_sc4,e_obj_add_s6_sc5"
  e_obj_add_s6_sc1:       "objective add o_s6_sc1"
  e_obj_add_s6_sc2:       "objective add o_s6_sc2"
  e_obj_add_s6_sc3:       "objective add o_s6_sc3"
  e_obj_add_s6_sc4:       "objective add o_s6_sc4"
  e_obj_add_s6_sc5:       "objective add o_s6_sc5"

  e_s6_sc_add_point:      "point sc_count 1 action:add"

  # Sc1
  e_s6_got_sc1:           "folder e_s6_add_tag_sc1,e_s6_sc_add_point,core-sfx.e_coin,e_s6_notify_sc1,if_all_sc_s6"
  e_s6_add_tag_sc1:       "tag add sc1"
  e_s6_notify_sc1:        "notify &3Secret coin #1 found! %point.sc_count.amount%/?"
  # Sc2
  e_s6_got_sc2:           "folder e_s6_add_tag_sc2,e_s6_sc_add_point,core-sfx.e_coin,e_s6_notify_sc2,if_all_sc_s6"
  e_s6_add_tag_sc2:       "tag add sc2"
  e_s6_notify_sc2:        "notify &3Secret coin #2 found! %point.sc_count.amount%/?"
  # Sc3
  e_s6_got_sc3:           "folder e_s6_add_tag_sc3,e_s6_sc_add_point,core-sfx.e_coin,e_s6_notify_sc3,if_all_sc_s6"
  e_s6_add_tag_sc3:       "tag add sc3"
  e_s6_notify_sc3:        "notify &3Secret coin #3 found! %point.sc_count.amount%/?"
  # Sc4
  e_s6_got_sc4:           "folder e_s6_add_tag_sc4,e_s6_sc_add_point,core-sfx.e_coin,e_s6_notify_sc4,if_all_sc_s6"
  e_s6_add_tag_sc4:       "tag add sc4"
  e_s6_notify_sc4:        "notify &3Secret coin #4 found! %point.sc_count.amount%/?"
  # Sc5
  e_s6_got_sc5:           "folder e_s6_add_tag_sc5,e_s6_sc_add_point,core-sfx.e_coin,e_s6_notify_sc5,if_all_sc_s6"
  e_s6_add_tag_sc5:       "tag add sc5"
  e_s6_notify_sc5:        "notify &3Secret coin #5 found! %point.sc_count.amount%/?"
 
  # Check win
  if_all_sc_s6:           "if chk_s6_all_sc e_s6_all_sc_gotten else core-main.e_dummy"

  e_s6_all_sc_gotten:     "folder e_s6_spawn_star,e_s6_summon_firework,core-sfx.e_star_spawn,e_s6_notif_spawn_star,e_obj_add_s6_star,e_s6_gp_add_star,e_s6_tag_add_spawned"
  e_s6_spawn_star:        "setblock RAW_GOLD_BLOCK $s6.star_loc$"
  e_s6_summon_firework:   "command execute in minecraft:overworld run summon firework_rocket $s6.star_loc_xyz$ {LifeTime:10,Motion:[0d,1d,0d],shotAtAngle:1b,FireworksItem:{id:firework_rocket,Count:1,tag:{Fireworks:{Flight:20,Explosions:[{Type:1,Flicker:1b,Colors:[I;14602026]},{Colors:[I;11743532]},{Colors:[I;4312372]}]}}}}"
  e_s6_notif_spawn_star:  "notify &3A star has spawned! io:title"
  e_obj_add_s6_star:      "objective add o_s6_star"
  e_s6_gp_add_star:       "globalpoint ssl_s6 1 action:add"
  e_s6_tag_add_spawned:   "tag add s6_spawned"

  # Win
  win_s6:                 "folder e_notif_s6_win,core-sfx.e_got_star,deit_s6,if_firstwin_s6"
  e_notif_s6_win:         "notify &3Pyramid puzzle\n&2Cleared! io:title"

  # First win
  if_firstwin_s6:         "if !chk_s6_obtained firstwin_s6 else core-main.e_dummy"
  firstwin_s6:            "folder e_broad_s6_first,tag_add_s6_win,e_stop_music,exit_star"
  e_broad_s6_first:       "command broadcast &6%player% &2got a star: [SSL] Pyramid puzzle"
  tag_add_s6_win:         "tag add s6"

 # Cleanup
  deit_s6:                "folder e_s6_del_obj_sc,e_s6_sc_del_point,e_obj_del_s6_star,e_s6_del_tags,if_s6_spawned,e_s6_tag_del_spawned"
  e_s6_del_obj_sc:        "folder e_obj_del_s6_sc1,e_obj_del_s6_sc2,e_obj_del_s6_sc3,e_obj_del_s6_sc4,e_obj_del_s6_sc5"
  e_obj_del_s6_sc1:       "objective remove o_s6_sc1"
  e_obj_del_s6_sc2:       "objective remove o_s6_sc2"
  e_obj_del_s6_sc3:       "objective remove o_s6_sc3"
  e_obj_del_s6_sc4:       "objective remove o_s6_sc4"
  e_obj_del_s6_sc5:       "objective remove o_s6_sc5"

  e_s6_sc_del_point:      "point sc_count 0 action:set"

  e_obj_del_s6_star:      "objective remove o_s6_star"
  e_s6_del_tags:          "run ^tag delete sc1 ^tag delete sc2 ^tag delete sc3 ^tag delete sc4 ^tag delete sc5"

  if_s6_spawned:          "if chk_s6_spawned e_s6_del_spawned else core-main.e_dummy"
  e_s6_del_spawned:       "folder e_s6_gp_sub_star,if_s6_despawn"
  e_s6_gp_sub_star:       "globalpoint ssl_s6 1 action:subtract"

  if_s6_despawn:          "if !chk_s6_spawn_count e_s6_delete_star else core-main.e_dummy"
  e_s6_tag_del_spawned:   "tag delete s6_spawned"

  e_s6_delete_star:       "folder e_s6_despawn_star,e_s6_reset_star_count"
  e_s6_despawn_star:      "setblock AIR $s6.star_loc$"
  e_s6_reset_star_count:  "globalpoint ssl_s6 0 action:set"


conditions:
  chk_s6_obtained:        "tag s6"
  chk_s6_tag_sc1:         "tag sc1"
  chk_s6_tag_sc2:         "tag sc2"
  chk_s6_tag_sc3:         "tag sc3"
  chk_s6_tag_sc4:         "tag sc4"
  chk_s6_tag_sc5:         "tag sc5"
  chk_s6_all_sc:          "and chk_s6_tag_sc1,chk_s6_tag_sc2,chk_s6_tag_sc3,chk_s6_tag_sc4,chk_s6_tag_sc5"

  chk_s6_spawned:         "tag s6_spawned"
  chk_s6_spawn_count:     "globalpoint ssl_s6 1"


objectives:
  o_s6_star:              "action right any loc:$s6.star_loc$ events:win_s6"
  o_s6_sc1:               "action right any loc:$s6.sc1$ events:e_s6_got_sc1"
  o_s6_sc2:               "action right any loc:$s6.sc2$ events:e_s6_got_sc2"
  o_s6_sc3:               "action right any loc:$s6.sc3$ events:e_s6_got_sc3"
  o_s6_sc4:               "action right any loc:$s6.sc4$ events:e_s6_got_sc4"
  o_s6_sc5:               "action right any loc:$s6.sc5$ events:e_s6_got_sc5"
