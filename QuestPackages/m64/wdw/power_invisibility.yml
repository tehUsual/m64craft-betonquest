variables:
  invis_block_1:          -477;81;410;marocraft

  invis_to_2:             -445;78;408;marocraft;-90;12


events:
 # Invisibility: Init
  e_init_invis:           "folder e_obj_add_inv_act_1,e_obj_add_inv_tp_all"
  e_obj_add_inv_act_1:    "objective add o_invis_activate_1"
  e_obj_add_inv_tp_all:   "folder e_obj_add_inv_tp_1"
  e_obj_add_inv_tp_1:     "objective add o_invis_tp_1"

  # Invisibility: Activate
  e_start_invis:          "folder m64-sfx.e_play_powerup,e_obj_add_inv_timout,e_tag_add_invis,e_notif_invisible,e_efx_give_invis"
  e_obj_add_inv_timout:   "objective add o_invis_timeout"
  e_tag_add_invis:        "tag add invisible"
  e_notif_invisible:      "notify &3Invisibility for 30 sec\n&2You can go through the cage io:title"
  e_efx_give_invis:       "effect INVISIBILITY 30 1 hidden noicon"

  # Invisibility: Deactivate
  e_cleanup_invis:        "folder e_reset_invis,e_obj_del_inv_act_1,e_obj_del_inv_timout,e_obj_del_inv_tp_all"

  e_stop_invis:           "folder e_play_music,e_reset_invis"

  e_reset_invis:          "folder e_tag_del_invis,e_efx_clear,e_efx_give_nightvis,e_efx_give_swim"
  e_tag_del_invis:        "tag delete invisible"
  e_efx_clear:            "command effect clear %player%"
  e_obj_del_inv_timout:   "objective remove o_invis_timeout"
  e_obj_del_inv_act_1:    "objective remove o_invis_activate_1"

  e_obj_del_inv_tp_all:   "folder e_obj_del_inv_tp_1"
  e_obj_del_inv_tp_1:     "objective remove o_invis_tp_1"

  # Invisibility: Tp
  e_invis_tp_1_to_2:      "teleport $invis_to_2$"


conditions:
  # Invisibility
  chk_tag_invisible:      "tag invisible"


objectives:
  # Invisibility
  o_invis_activate_1:     "action right any loc:$invis_block_1$ conditions:!chk_tag_invisible events:e_start_invis persistent"
  o_invis_timeout:        "delay 30 seconds interval:5 event:e_stop_invis"

  o_invis_tp_1:           "region wdw_inv_tp_1 enter conditions:chk_tag_invisible events:e_invis_tp_1_to_2 persistent"